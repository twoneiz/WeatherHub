<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Weather Hub</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <header class="py-3 mb-3 glass-navbar shadow-sm">
    <div class="container d-flex flex-wrap justify-content-between align-items-center">
      <div class="d-flex align-items-center gap-2">
        <span class="navbar-logo rounded-circle d-flex align-items-center justify-content-center">
          <i class="bi bi-cloud-sun-fill"></i>
        </span>
        <div class="fw-bold fs-4 translatable">Weather Hub</div>
      </div>
      <div class="d-flex align-items-center gap-2">
        <select id="languageSelect" class="form-select form-select-sm" style="min-width:140px;">
          <option value="en" selected>English</option>
        </select>
        <button id="themeToggle" class="btn btn-outline-secondary btn-sm" title="Toggle dark/light mode">
          <i class="bi bi-moon-stars-fill" id="themeIcon"></i>
        </button>
      </div>
    </div>
  </header>

  <main class="container mb-4">
    <div class="row g-3">
      <div class="col-lg-8">
        <div class="mb-2 d-flex flex-wrap align-items-center control-row">
          <select id="weatherLayerSelect" class="form-select form-select-sm" style="max-width:220px;">
            <option value="none">Overlay</option>
            <option value="clouds_new">Clouds</option>
            <option value="precipitation_new">Rain</option>
            <option value="temp_new">Temperature</option>
            <option value="wind_new">Wind</option>
            <option value="pressure_new">Pressure</option>
            <option value="pressure_cntr">Pressure contours</option>
            <option value="snow">Snow</option>
          </select>
        </div>
        <div id="map" style="width:100%;height:520px;border-radius:16px;"></div>
      </div>
      <div class="col-lg-4">
        <div class="frosted p-3 weather-main-card">
          <div class="d-flex align-items-center justify-content-between mb-2">
            <div class="d-flex align-items-center gap-2">
              <i class="bi bi-geo-alt"></i>
              <div id="locationName" class="fw-bold translatable">Locating...</div>
            </div>
            <button class="btn btn-light btn-sm" id="locateBtn" title="Use my location">
              <i class="bi bi-crosshair"></i>
            </button>
          </div>
          <div class="display-4 fw-bold" id="weatherTemp">--&deg;C</div>
          <div id="weatherMain" class="mb-2 text-capitalize">--</div>
          <div class="text-muted small mb-2" id="updatedAt">--</div>
          <div class="row text-center g-2 quick-stats mb-2">
            <div class="col">
              <div class="small text-uppercase translatable">Feels</div>
              <div id="realFeel">--</div>
            </div>
            <div class="col">
              <div class="small text-uppercase translatable">Humidity</div>
              <div id="humidity">--</div>
            </div>
            <div class="col">
              <div class="small text-uppercase translatable">Wind</div>
              <div id="windSpeed">--</div>
            </div>
          </div>
          <div class="row text-center g-2 mb-3">
            <div class="col">
              <div class="small text-uppercase translatable">Temp. Range</div>
              <div id="tempRange">-- / --</div>
            </div>
            <div class="col">
              <div class="small text-uppercase translatable">Pressure</div>
              <div id="pressure">--</div>
            </div>
          </div>
          <div class="row g-2 detail-grid mb-3">
            <div class="col-6">
              <div class="stat-tile d-flex justify-content-between align-items-center p-2">
                <div>
                  <div class="small text-uppercase translatable">Visibility</div>
                  <div class="fw-semibold" id="visibility">--</div>
                </div>
                <i class="bi bi-binoculars"></i>
              </div>
            </div>
            <div class="col-6">
              <div class="stat-tile d-flex justify-content-between align-items-center p-2">
                <div>
                  <div class="small text-uppercase translatable">Clouds</div>
                  <div class="fw-semibold" id="cloudCover">--</div>
                </div>
                <i class="bi bi-clouds"></i>
              </div>
            </div>
            <div class="col-6">
              <div class="stat-tile d-flex justify-content-between align-items-center p-2">
                <div>
                  <div class="small text-uppercase translatable">Rain</div>
                  <div class="fw-semibold" id="precipProb">--</div>
                </div>
                <i class="bi bi-umbrella"></i>
              </div>
            </div>
            <div class="col-6">
              <div class="stat-tile d-flex justify-content-between align-items-center p-2">
                <div>
                  <div class="small text-uppercase translatable">Wind Directions</div>
                  <div class="fw-semibold" id="windDirection">--</div>
                </div>
                <i class="bi bi-compass"></i>
              </div>
            </div>
          </div>
          <div class="surface-divider"></div>
          <div class="row text-center mb-2">
            <div class="col">
              <i class="bi bi-sunrise"></i> <span id="sunriseTime">--:--</span>
            </div>
            <div class="col">
              <i class="bi bi-sunset"></i> <span id="sunsetTime">--:--</span>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="row g-3 mt-1">
      <div class="col-lg-8">
        <div class="frosted p-3 forecast-panel">
          <div class="d-flex justify-content-between align-items-center mb-2">
            <div class="fw-semibold small text-uppercase">Hourly Forecast</div>
            <div class="text-muted small" id="forecastCaption">Next 3 Hour</div>
          </div>
          <div id="hourlyForecast" class="forecast-scroll"></div>
        </div>
      </div>
      <div class="col-lg-4">
        <div class="frosted p-3 forecast-panel">
          <div class="fw-semibold small text-uppercase mb-2">Daily Forecast</div>
          <div id="dailyForecast" class="forecast-scroll"></div>
        </div>
      </div>
    </div>
  </main>

  <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyA4GymxbXBaasNQd-Gl5XnztNBKs334kpM&libraries=places"></script>
  <script src="js/map.js"></script>
  <script src="js/translate.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
  <script>
    const themeToggle = document.getElementById('themeToggle');
    const themeIcon = document.getElementById('themeIcon');
    themeToggle.onclick = () => {
      document.body.classList.toggle('dark-mode');
      const dark = document.body.classList.contains('dark-mode');
      themeIcon.classList.toggle('bi-brightness-high-fill', dark);
      themeIcon.classList.toggle('bi-moon-stars-fill', !dark);
      localStorage.setItem('weather-theme', dark ? 'dark' : 'light');
    };
    if (localStorage.getItem('weather-theme') === 'dark') {
      document.body.classList.add('dark-mode');
      themeIcon.classList.remove('bi-moon-stars-fill');
      themeIcon.classList.add('bi-brightness-high-fill');
    }

    document.addEventListener('DOMContentLoaded', () => {
      initTranslation();
    });
  </script>
</body>
</html>
